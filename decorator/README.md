# Decorator Method

Github: https://github.com/Kim-deokhyeon/DesignPatternWithFlutter/tree/main/template_method
λ‹΄λ‹Ήμ: μµλ…
μƒνƒ: μ΄μ• π› 
μƒμ„±μΌμ‹: 2022λ…„ 1μ›” 11μΌ μ¤ν›„ 11:42
μµμΆ… νΈμ§‘μΌμ‹: 2022λ…„ 1μ›” 12μΌ μ¤μ „ 1:18

<aside>
π’΅ **Move Embellishment to Decorator**

> μ–΄λ–¤ ν΄λμ¤μ— ν•µμ‹¬ κΈ°λ¥μ„ μ„ν• μ½”λ“μ™€ κΎΈλ° μ½”λ“κ°€ λ’¤μ„μ—¬ μμΌλ©΄, κΎΈλ° μ½”λ“λ¥Ό λ°μ½”λ μ΄ν„° `decorator`λ΅ μ®κΈ΄λ‹¤
> 
</aside>

# π© λ™κΈ°

 μ‹μ¤ν…μ— μƒ κΈ°λ¥μ„ μ¶”κ°€ν•΄μ•Ό ν•  λ•λ©΄, λ³΄ν†µμ€ κΈ°μ΅΄ ν΄λμ¤μ— μ½”λ“λ¥Ό λ§λ¶™μΈλ‹¤. μ΄λ ‡κ² μƒλ΅ μ¶”κ°€λ μ½”λ“λ” κΈ°μ΅΄ ν΄λμ¤μ ν•µμ‹¬ κΈ°λ¥ λλ” μ£Όλ ν–‰λ™ μ–‘μ‹μ— λ€ν• κΎΈλ° μ½”λ“λ΅μ„ λ™μ‘ν•λ” κ²½μ°κ°€ λ§λ‹¤. λ¬Έμ λ” μ΄λ° κΎΈλ° μ½”λ“λ΅ μΈν•΄ μƒλ΅μ΄ ν•„λ“ λλ” λ©”μ„λ“, λ΅μ§μ΄ μ¶”κ°€λκ³  νΈμ¤νΈ ν΄λμ¤κ°€ λ³µμ΅ν•΄μ§„λ‹¤λ” κ²ƒμ΄λ‹¤. κ²λ‹¤κ°€ μƒλ΅ μ¶”κ°€λ λ¶€λ¶„μ€ νΉμ • μ΅°κ±΄μ—μ„λ§ μ“°μ΄λ” κ²ƒμ΄λ‹¤.

### ν¬λ…ν• μ™Έν¬

νΈμ¤νΈ ν΄λμ¤κ°€ μ κ³µν•λ” λ¨λ“  public λ©”μ„λ“λ¥Ό λ°μ½”λ μ΄ν„°λ„ κµ¬ν„ν•΄μ•Ό ν•λ‹¤.

νΈμ¤νΈ ν΄λμ¤μ— public λ©”μ„λ“κ°€ λ§λ‹¤λ©΄, μ“Έλ°μ—†λ” μ½”λ“κ°€ λ°μ½”λ μ΄ν„°μ— μƒκΈΈ κ°€λ¥μ„±μ΄ ν¬λ‹¤.

ν΄λΌμ΄μ–ΈνΈμ— κ°μ²΄μ νƒ€μ…μ„ λ…μ‹μ μΌλ΅ κ²€μ‚¬ν•λ” μ½”λ“κ°€ μλ‹¤λ©΄, λ°μ½”λ μ΄ν„° κ°μ²΄μ™€ κ·Έ λ€μƒμ΄ λλ” κ°μ²΄μ νƒ€μ…μ΄ λ‹¤λ¥΄κΈ° λ•λ¬Έμ— λ¬Έμ κ°€ μƒκΈΈ μ μλ‹¤.

λ”°λΌμ„ κ°μ²΄μ νƒ€μ…μ— μμ΅΄ν•μ§€ μ•λ„λ΅ ν΄λΌμ΄μ–ΈνΈμ μ½”λ“λ¥Ό μμ •ν•λ” κ²ƒμ΄ κ°€λ¥ν•λ―€λ΅ ν° λ¬Έμ κ°€ λμ§€λ” μ•λ”λ‹¤.

### λ‹¤μ–‘ν• λ°μ½”λ μ΄ν„°

λ°μ½”λ μ΄ν„° ν΄λμ¤κ°€ μ—¬λΏ μ΅΄μ¬ν•λ” κ²½μ°λ„ κ³ λ ¤ν•΄μ•Ό ν•λ‹¤.

μ μΉ λ λ°μ½”λ μ΄ν„° ν΄λμ¤μ μμ„λ΅ μΈν•΄ μ›ν•μ§€ μ•λ” κ²°κ³Όκ°€ λ‚μ¬ μ λ„ μλ‹¤.

μλ¥Ό λ“¤μ–΄ μ•”νΈν™” κΈ°λ¥μ„ κ°€μ§„ λ°μ½”λ μ΄ν„°μ™€ ν•„ν„°λ§ λ λ°μ½”λ μ΄ν„°μ κ²½μ°, μ•”νΈν™” ν›„ ν•„ν„°λ§μ€ ν•„ν„°λ§μ μλ―Έκ°€ μ—†μ–΄μ§„λ‹¤.

μ„λ΅ λ…λ¦½μ μ΄κ² μ‘μ„±ν•  μ μμΌλ©΄ μΆ‹μ§€λ§, κ·Έλ ‡μ§€ λ»ν•  κ²½μ°, **Encapsulate Classes with Factory** λ“±μ„ ν†µν•΄ μ•μ „ν• μ΅°ν•©μ„ μ κ³µν•λ” νΉλ³„ν• μƒμ„± λ©”μ„λ“λ¥Ό μ κ³µν•λ” κ²ƒμ΄ μΆ‹λ‹¤.

### μ¥μ κ³Ό λ‹¨μ 

| μ¥μ                                                          | λ‹¨μ                                                                                       |
| ------------------------------------------------------------ | ----------------------------------------------------------------------------------------- |
| κΎΈλ° μ½”λ“λ¥Ό μ κ±°ν•΄ νΈμ¤νΈ ν΄λμ¤λ¥Ό λ‹¨μν•κ² λ§λ“ λ‹¤.          | ν΄λΌμ΄μ–ΈνΈμ μ…μ¥μ—μ„λ” λ€μƒ κ°μ²΄μ νƒ€μ…μ΄ λ°”λ€λ‹¤.                                        |
| μ–΄λ–¤ ν΄λμ¤μ ν•µμ‹¬ κΈ°λ¥κ³Ό λ¶€κ°€ κΈ°λ¥μ„ μ†μ‰½κ² κµ¬λ³„ν•  μ μλ‹¤. | μ½”λ“λ¥Ό μ΄ν•΄ν•κ³  λ””λ²„κΉ…ν•κΈ° λ” μ–΄λ ¤μ›μ§ μλ„ μλ‹¤.                                         |
| μ„λ΅ κ΄€λ ¨λ ν΄λμ¤μ—μ„ μ¤‘λ³µλ κΎΈλ° μ½”λ“λ¥Ό μ¤„μΌ μ μλ‹¤.      | λ°μ½”λ μ΄ν„° κ°μ²΄μ μ΅°ν•© λ°©μ‹μ΄ μ„λ΅μ—κ² μν–¥μ„ λΌμΉλ‹¤λ©΄, μ„¤κ³„λ¥Ό λ” λ³µμ΅ν•κ² λ§λ“¤μ–΄μ•Ό ν•λ‹¤. |

# π”‘ μ μ°¨

### μ‚¬μ „ μ¤€λΉ„

- ν•µμ‹¬ κΈ°λ¥μ— λ‹¤λ¥Έ κΈ°λ¥μ„ μ¶”κ°€ν•κΈ° μ„ν• κΎΈλ° μ½”λ“λ¥Ό κ°€μ§€κ³  μλ” ν΄λμ¤λ¥Ό μ°Ύλ”λ‹¤.
- κΎΈλ° μ½”λ“λ¥Ό κ°€μ§€κ³  μλ‹¤κ³  λ¬΄μ΅°κ±΄ Decorator ν¨ν„΄μ„ μ μ©ν•΄ λ¦¬ν©ν„°λ§ ν•΄μ•Όν•λ” κ²ƒμ€ μ•„λ‹λ‹¤.
- λ¦¬ν©ν„°λ§μ„ ν•κΈ°λ΅ κ²°μ •ν•κΈ° μ „μ— λ°μ½”λ μ΄ν„° ν΄λμ¤κ°€ κµ¬ν„ν•΄μ•Ό ν•  public λ©”μ„λ“κ°€ λ§μ§€ μ•μ€μ§€ ν™•μΈν•΄λ³΄μ•„μ•Ό ν•λ‹¤.
- λ©”μ„λ“κ°€ λ„λ¬΄ λ§μ€ κ²½μ° μ μ ν• μ‘μ—…μ„ ν†µν•΄ κ·Έ μλ¥Ό μ¤„μ΄κ±°λ‚, **Replace Conditional Login with Strategy** λ¦¬ν©ν„°λ§κ³Ό κ°™μ€ λ€μ•μ„ κ³ λ ¤ν•΄μ•Ό ν•λ‹¤.

### 1. μΈν΄λ΅μ € νƒ€μ… `enclosure type`μ„ μ°Ύμ•„λ‚΄κ±°λ‚ μƒλ΅ λ§λ“ λ‹¤.

- μΈν΄λ΅μ € νƒ€μ…μ΄λ€,
    
    νΈμ¤νΈ ν΄λμ¤μ ν΄λΌμ΄μ–ΈνΈκ°€ μ‚¬μ©ν•λ” λ¨λ“  public λ©”μ„λ“λ¥Ό μ κ³µν•λ” ν΄λμ¤ λλ” μΈν„°νμ΄μ¤λ΅, λ°μ½”λ μ΄ν„° ν΄λμ¤μ™€ νΈμ¤νΈ ν΄λμ¤ λ‘ λ¨λ‘μ— λ€ν• μνΌνƒ€μ…μ΄ λ  μ΅΄μ¬λ‹¤.
    
- κ²½μ°μ— λ”°λΌ μΈν΄λ΅μ € νƒ€μ…μ„ μƒλ΅ λ§λ“¤ ν•„μ” μ—†μ΄, νΈμ¤νΈ ν΄λμ¤κ°€ κµ¬ν„ν• μΈν„°νμ΄μ¤ νƒ€μ…μ΄λ‚ νΈμ¤νΈ ν΄λμ¤μ μνΌν΄λμ¤λ¥Ό κ·Έλ€λ΅ μ΄μ©ν•  μ μλ‹¤.
- κ·Έλ¬λ‚ κ·Έλ¬ν• ν΄λμ¤κ°€ λ°μ΄ν„°λ¥Ό μ μ§€ν•κ³  μλ‹¤λ©΄ μΈν΄λ΅μ € νƒ€μ…μΌλ΅ μ λ‹Ήν•μ§€ μ•λ‹¤.
    
    β†’ λ°μ½”λ μ΄ν„°λ” κ·Έλ° λ°μ΄ν„°κ°€ ν•„μ”μ—†μμ—λ„ μƒμ† λ°›κΈ° λ•λ¬Έμ—
    
- μΈν΄λ΅μ € νƒ€μ…μΌλ΅ μ‚¬μ©ν•  μ λ‹Ήν• ν›„λ³΄κ°€ μ—†μΌλ©΄, **Unify Intefaces** λ¦¬ν©ν„°λ§ λλ” **Extract Interface** λ¦¬ν©ν„°λ§μ„ ν†µν•΄ μƒλ΅ λ§λ“¤μ–΄μ•Ό ν•λ‹¤.

### 2. νΈμ¤νΈ ν΄λμ¤μ—μ„ κΎΈλ° μ½”λ“μ— ν•΄λ‹Ήν•λ” μ΅°κ±΄ λ΅μ§μ„ μ°Ύμ•„μ„ *Replace Conditional with Polymorphism* λ¦¬ν©ν„°λ§μ„ ν†µν•΄ μ κ±°ν•λ‹¤.

- **Replace Conditional with Polymorphism** μ„ μ μ©ν•κΈ° μ„ν•΄μ„  μ μ ν• μƒμ† κµ¬μ΅°κ°€ μ”κµ¬λκΈ° λ•λ¬Έμ— **Replace Type Code with Subclasses** λλ” **Replace Type Code with State/Strategy**λ¥Ό μ‚¬μ©ν•΄μ•Ό ν•λ‹¤.
- **Replace Type Code with Subclasses**μ ****μ μ°¨μ—μ„ κ·Έ μ²« λ‹¨κ³„λ΅ νƒ€μ… μ½”λ“λ¥Ό μμ²΄ μΊ΅μν™” `self-encapsulation`λ¥Ό ν•  κ²ƒμ„ μ μ‹ν•κ³  μμΌλ©°, κ·Έ μ§€μΉ¨μ— λ”°λΌ νƒ€μ… μ½”λ“μ— λ€ν• get λ©”μ„λ“λ¥Ό λ§λ“¤ κ²½μ°, λ¦¬ν„΄ νƒ€μ…μ΄ μ• λ‹¨κ³„μ μΈν΄λ΅μ € νƒ€μ…μ΄λ„λ΅ ν•λ” κ²ƒμ΄ μ¤‘μ”ν•λ‹¤.
- μνΌν΄λμ¤μ—μ„ νƒ€μ… μ½”λ“ ν•„λ“λ¥Ό μ κ±°ν•  λ•, νƒ€μ… μ½”λ“μ— λ€ν• get/set λ©”μ„λ“λ¥Ό μ¶”μƒμΌλ΅ μ„ μ–Έν•λΌκ³  ν•μ§€λ§, κµ³μ΄ κ·Έλ΄ ν•„μ”λ” μ—†λ‹¤.
- κΎΈλ° μ½”λ“μ μ•μ΄λ‚ λ’¤μ—μ„ μ‹¤ν–‰ν•΄μ•Ό ν•  λ΅μ§μ΄ μλ‹¤λ©΄, **Replace Conditional with Polymorphism** λ¦¬ν©ν„°λ§κ³Ό ν•¨κ» **Form Template Method** λ¦¬ν©ν„°λ§μ„ μ‚¬μ©ν•  μ μλ‹¤.

### 3. *Replace Inheritance with Delegation* λ¦¬ν©ν„°λ§μ„ μ΄μ©ν•΄ μ΄ μ„λΈν΄λμ¤λ“¤μ„ μ„μ„ ν΄λμ¤`delegating class`λ΅ λ³€ν™ν•λ‹¤.

- μ„μ„ ν΄λμ¤λ” λ¨λ‘ μΈν΄λ΅μ € νƒ€μ…μ„ κµ¬ν„ν•λ„λ΅ ν•λ‹¤.
- μ„μ„ ν΄λμ¤μ λ€λ¦¬ κ°μ²΄ ν•„λ“λ„ μΈν΄λ΅μ € νƒ€μ…μΌλ΅ ν•λ‹¤.
- κΎΈλ° μ½”λ“λ¥Ό μ„μ„ ν΄λμ¤κ°€ μ„μ„ λ©”μ„λ“λ¥Ό νΈμ¶ν•κΈ° μ „μ— μ‹¤ν–‰ν•  κ²ƒμΈμ§€ μ•„λ‹λ©΄ κ·Έ ν›„μ— μ‹¤ν–‰ν•  κ²ƒμΈμ§€λ¥Ό κ²°μ •ν•λ‹¤.
- **Form Template Method** λ¦¬ν©ν„°λ§μ„ μ μ©ν–λ‹¤λ©΄, μ„μ„ ν΄λμ¤μ—μ„ λ€λ¦¬ κ°μ²΄μ publicμ΄ μ•„λ‹ λ©”μ„λ“λ¥Ό νΈμ¶ν•΄μ•Όν•  μƒν™©μ΄ λ²μ–΄μ§ μ μλ‹¤.
    
    κ·Έλ¬ν• κ²½μ° ν•΄λ‹Ή λ©”μ„λ“λ¥Ό publicμΌλ΅ λ³€κ²½ν•κ³  **Unify Interfaces** λ¦¬ν©ν„°λ§μ„ λ‹¤μ‹ μ μ©ν•λ‹¤.
    

### 4. κ° μ„μ„ ν΄λμ¤μ λ€λ¦¬ κ°μ²΄ ν•„λ“μ— νΈμ¤νΈ ν΄λμ¤μ μƒ μΈμ¤ν„΄μ¤λ¥Ό λ§λ“¤μ–΄ λ€μ…ν•λ‹¤.

- μ΄ λ€μ…λ¬Έμ€ μ„μ„ ν΄λμ¤μ μƒμ„±μμ— μ„μΉν•΄μ•Ό ν•λ‹¤.
- νΈμ¤νΈ ν΄λμ¤μ μΈμ¤ν„΄μ¤λ¥Ό μƒμ„±ν•λ” μ½”λ“μ— Extract Parameter λ¦¬ν©ν„°λ§μ„ μ μ©ν•΄ νλΌλ―Έν„°λ΅ λ½‘μ•„λ‚Έλ‹¤.
- μƒμ„±μμ νλΌλ―Έν„° μ¤‘ λ¶ν•„μ”ν• κ²ƒμ΄ μλ‹¤λ©΄ Remoe Paramter λ¦¬ν©ν„°λ§μ„ μ΄μ©ν•μ—¬ μ κ±°ν•λ‹¤.

# π—’οΈ μ½”λ“

### 1. μΈν΄λ΅μ € νƒ€μ… κµ¬ν„

λ°μ½”λ μ΄ν„° ν΄λμ¤μ— μΈν„°νμ΄μ¤λ¥Ό μ „λ‹¬ν•κΈ° μ„ν•΄μ„ μΈν΄λ΅μ € νƒ€μ… Pizzaμ„ abstract classλ΅ κµ¬ν„

λ°μ½”λ μ΄ν„° ν΄λμ¤λ΅ κΎΈλ©°μ§€κΈ° μ„ν• νΈμ¤νΈ ν΄λμ¤μΈ PizzaBaseμ™€ λ°μ½”λ μ΄ν„° ν΄λμ¤μ κµ¬λ¶„μ„ μ„ν• μΈν„°νμ΄μ¤μΈ PizzaDecorator ν΄λμ¤ μƒμ„±.

```dart
abstract class Pizza {
  @protected
  late String description;

  String getDescription();
  double getPrice();
}

class PizzaBase extends Pizza {
  PizzaBase(String description) {
    this.description = description;
  }

  @override
  String getDescription() {
    return description;
  }

  @override
  double getPrice() {
    return 3.0;
  }
}

abstract class PizzaDecorator extends Pizza {
  final Pizza pizza;

  PizzaDecorator(this.pizza);

  @override
  String getDescription() {
    return pizza.getDescription();
  }

  @override
  double getPrice() {
    return pizza.getPrice();
  }
}
```

### 2. λ°μ½”λ μ΄ν„° ν΄λμ¤ κµ¬ν„

PizzaDecoratorμ μΈν„°νμ΄μ¤λ¥Ό μƒμ†ν•΄ λ©”μ„λ“λ¥Ό μ‘μ„±ν• λ°μ½”λ μ΄ν„° ν΄λμ¤.

μΈν΄λ΅μ € νƒ€μ…μΈ Pizzaμ μƒνƒλ¥Ό Return ν•  μ μλ„λ΅ μ‘μ„±ν•΄μ•Ό ν•¨.

Decorator μ¤‘μ²©μ„ ν†µν•΄μ„ Pizzaμ descriptionκ³Ό priceλ¥Ό μ“μ•„κ°

```dart
class Basil extends PizzaDecorator {
  Basil(Pizza pizza) : super(pizza) {
    description = 'Basil';
  }

  @override
  String getDescription() {
    return '${pizza.getDescription()}\n- $description';
  }

  @override
  double getPrice() {
    return pizza.getPrice() + 0.2;
  }
}

class Mozzarella extends PizzaDecorator {
  Mozzarella(Pizza pizza) : super(pizza) {
    description = 'Mozzarella';
  }

  @override
  String getDescription() {
    return '${pizza.getDescription()}\n- $description';
  }

  @override
  double getPrice() {
    return pizza.getPrice() + 0.5;
  }
}

													....

class OliveOil extends PizzaDecorator {
  OliveOil(Pizza pizza) : super(pizza) {
    description = 'Olive Oil';
  }

  @override
  String getDescription() {
    return '${pizza.getDescription()}\n- $description';
  }

  @override
  double getPrice() {
    return pizza.getPrice() + 0.1;
  }
}
```

### 3. κµ¬ν„ λ ν΄λμ¤μ μ‚¬μ©

μΈν΄λ΅μ € νƒ€μ…μΈ Pizzaλ¥Ό κµ¬ν„ν• λ°μ½”λ μ΄ν„° ν΄λμ¤λ΅ κΎΈλ°μ„ λ°λ³µν•κ² λλ©΄, getDescritionκ³Ό getPriceλ¥Ό ν†µν•΄ κ³„μ† κ°’μ΄ μ“μ—¬κ°μ„ ν™•μΈν•  μ μλ‹¤.

```dart
void main() {
  Pizza pizza1 = PizzaBase('pizza1');
  pizza1 = Sauce(pizza1);
  pizza1 = Mozzarella(pizza1);
  pizza1 = Basil(pizza1);

  print(pizza1.getDescription());

  Pizza pizza2 = PizzaBase('pizza2');
  pizza2 = Sauce(pizza2);
  pizza2 = Mozzarella(pizza2);
  pizza2 = Basil(pizza2);

  print(pizza2.getDescription());
}
```